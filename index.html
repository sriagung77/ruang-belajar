<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ruang Belajar Interaktif</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;800&display=swap" rel="stylesheet">
    <style>
        /* --- STYLE BARU LEBIH BERSIH & GRADASI HALUS --- */
        body {
            font-family: 'Nunito', sans-serif;
            margin: 0; padding: 0;
            /* Gradasi Background Premium */
            background: linear-gradient(120deg, #84fab0 0%, #8fd3f4 100%);
            min-height: 100vh;
            color: #444;
        }

        /* Navbar */
        .navbar {
            background: white;
            padding: 15px 5%;
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
            position: sticky; top: 0; z-index: 100;
        }
        .logo { 
            font-weight: 800; font-size: 1.4rem; color: #2d3436; 
            display: flex; align-items: center; gap: 10px; 
        }
        .logo i { color: #0984e3; }

        /* Tombol Admin */
        .btn-admin {
            background: #dfe6e9; color: #636e72;
            padding: 8px 20px; border-radius: 30px; border: none;
            font-weight: 700; cursor: pointer; transition: 0.3s;
            display: flex; align-items: center; gap: 8px; text-decoration: none;
        }
        .btn-admin:hover { background: #2d3436; color: white; }

        /* Container Grid */
        .container { max-width: 1100px; margin: 40px auto; padding: 0 20px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 25px; }

        /* Kartu Materi */
        .card {
            background: white; border-radius: 15px; overflow: hidden;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            transition: transform 0.3s; opacity: 0;
            animation: slideUp 0.6s forwards;
            display: flex; flex-direction: column;
        }
        @keyframes slideUp { from {opacity:0; transform:translateY(20px);} to {opacity:1; transform:translateY(0);} }
        .card:hover { transform: translateY(-8px); box-shadow: 0 15px 35px rgba(0,0,0,0.1); }

        /* Header Kartu (Icon Area) */
        .card-top {
            height: 140px; display: flex; justify-content: center; align-items: center;
            position: relative; color: white; font-size: 3.5rem;
        }
        .bg-video { background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 99%, #fecfef 100%); color: #d63031; }
        .bg-doc { background: linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%); color: #6c5ce7; }

        /* Label Tipe (Pojok Kanan Atas Kartu) */
        .badge {
            position: absolute; top: 15px; right: 15px;
            background: white; color: #333;
            padding: 5px 12px; border-radius: 20px;
            font-size: 0.7rem; font-weight: 800; text-transform: uppercase;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .card-body { padding: 25px; flex-grow: 1; display: flex; flex-direction: column; }
        .card h3 { margin: 0 0 10px; font-size: 1.1rem; line-height: 1.4; color: #2d3436; }
        .card p { font-size: 0.9rem; color: #b2bec3; margin-bottom: 20px; flex-grow: 1; }

        /* Tombol Aksi */
        .action-btn {
            display: block; width: 100%; text-align: center;
            padding: 12px 0; border-radius: 10px;
            text-decoration: none; font-weight: 700; font-size: 0.9rem;
            background: #74b9ff; color: white; transition: 0.2s;
        }
        .action-btn:hover { background: #0984e3; }
        
        .btn-download {
            background: #f1f2f6; color: #2d3436; margin-top: 10px;
        }
        .btn-download:hover { background: #dfe6e9; }

        /* Loading State */
        #loading { text-align: center; padding: 50px; font-size: 1.2rem; color: #555; }
    </style>
</head>
<body>

    <nav class="navbar">
        <div class="logo">
            <i class="fa-solid fa-book-open"></i> Ruang Belajar
        </div>
        <button onclick="menuAdmin()" class="btn-admin">
            <i class="fa-solid fa-lock"></i> Admin Upload
        </button>
    </nav>

    <div class="container">
        <div id="loading">
            <i class="fa-solid fa-spinner fa-spin"></i> Sedang mengambil data...
        </div>
        <div class="grid" id="app"></div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <script>
        /* =========================================================
           BAGIAN INI WAJIB DIEDIT DENGAN BENAR
           ========================================================= */

        // 1. Password Admin
        const PASS_ADMIN = "12345";

        // 2. Link Google Form (Link "Viewform" atau "Isi Form")
        const URL_FORM = "https://docs.google.com/forms/d/e/1FAIpQLSfUVBBYckdRMhpNxJ1NF5yH0TSHf1AQ7GlHq8VM0ASyPWDfUg/viewform?usp=dialog";

        // 3. Link CSV Google Sheet
        // CARA AMBIL LINK: File -> Share -> Publish to web -> Pilih 'CSV' -> Klik Publish -> Copy Link
        const URL_SHEET = "https://docs.google.com/spreadsheets/d/1DBUdlsmgjRXj-QE2jd1W93tMWfgWGbCTosGCjpE0u5c/edit?usp=sharing";

        /* ========================================================= */

        function menuAdmin() {
            let input = prompt("Masukkan Kode Akses Admin:");
            if(input === PASS_ADMIN) {
                // Buka Form di Tab Baru (Solusi 'refused to connect')
                window.open(URL_FORM, '_blank');
            } else if (input != null) {
                alert("Kode Salah!");
            }
        }

        Papa.parse(URL_SHEET, {
            download: true,
            header: false, // Kita baca manual agar aman
            complete: function(results) {
                const data = results.data;
                const container = document.getElementById('app');
                document.getElementById('loading').style.display = 'none';

                // Mulai loop dari baris ke-1 (baris 0 biasanya judul kolom)
                // Kita reverse() agar materi terbaru muncul paling atas
                data.slice(1).reverse().forEach((row, i) => {
                    
                    // --- FILTER ANTI ERROR / KODE ---
                    // Jika kolom judul kosong ATAU mengandung kode aneh, LEWATI (Skip)
                    if (!row[1] || row[1].includes('function') || row[1].includes('Disclaimer') || row[1].includes('{')) {
                        return; 
                    }

                    // Mapping Data (Sesuaikan urutan kolom di Sheet Anda)
                    // [0]Timestamp, [1]Judul, [2]Deskripsi, [3]Kategori, [4]LinkVideo, [5]LinkFile
                    const judul = row[1];
                    const deskripsi = row[2] || "Tidak ada deskripsi tambahan.";
                    const kategori = row[3] ? row[3].toLowerCase() : "dokumen";
                    const linkVideo = row[4];
                    const linkFile = row[5];

                    // Logika Tampilan
                    let linkUtama = '#';
                    let icon = 'fa-file-lines';
                    let bgClass = 'bg-doc';
                    let badgeText = 'DOKUMEN';

                    if (kategori.includes('video')) {
                        linkUtama = linkVideo;
                        icon = 'fa-play-circle';
                        bgClass = 'bg-video';
                        badgeText = 'VIDEO';
                    } else {
                        linkUtama = linkFile;
                        // Konversi Link Drive agar otomatis download
                        if(linkUtama && linkUtama.includes('drive.google.com') && linkUtama.includes('/view')) {
                            // Pakai Regex untuk ambil ID file dengan aman
                            const idMatch = linkUtama.match(/\/d\/(.*?)\//);
                            if(idMatch) {
                                linkUtama = `https://drive.google.com/uc?export=download&id=${idMatch[1]}`;
                            }
                        }
                    }

                    // Render HTML
                    const cardHTML = `
                        <div class="card" style="animation-delay: ${i * 0.1}s">
                            <div class="card-top ${bgClass}">
                                <div class="badge">${badgeText}</div>
                                <i class="fa-regular ${icon}"></i>
                            </div>
                            <div class="card-body">
                                <h3>${judul}</h3>
                                <p>${deskripsi}</p>
                                <a href="${linkUtama}" target="_blank" class="action-btn">
                                    ${kategori.includes('video') ? 'Tonton Video' : 'Download Materi'}
                                </a>
                            </div>
                        </div>
                    `;
                    container.innerHTML += cardHTML;
                });

                // Jika tidak ada data yang valid
                if(container.innerHTML === "") {
                    container.innerHTML = "<p style='text-align:center; grid-column:1/-1;'>Belum ada materi, atau Link CSV salah.</p>";
                }
            },
            error: function() {
                document.getElementById('loading').innerText = "Gagal memuat data. Cek Link CSV.";
            }
        });
    </script>
</body>
</html>

   
      
     



